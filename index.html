<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Graphics Final Project</title>

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.9.3/css/bulma.min.css"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
      :root {
        --primary-dark: #0a0e27;
        --secondary-dark: #1a1f3a;
        --accent-blue: #00d4ff;
        --accent-purple: #9b7fb9;
        --accent-pink: #ff006e;
        --text-light: #e0e6ed;
        --text-muted: #8b95a8;
        --card-bg: #ffffff;
        --header-height: 5rem;
      }

      html,
      body {
        min-height: 100%;
        margin: 0;
        font-family: 'Rajdhani', sans-serif;
      }

      body {
        background: #f8f9fa;
        background-attachment: fixed;
        color: #2c3e50;
      }

      .section {
        padding: 0.5rem 0;
      }

      .header-section {
        padding: 1.5rem 0;
        text-align: center;
        background: var(--accent-purple);
        box-shadow: 0 4px 20px rgba(155, 127, 185, 0.3);
        margin-bottom: 1.5rem;
      }

      .title {
        font-family: 'Orbitron', sans-serif;
        font-weight: 900;
        color: #ffffff;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        letter-spacing: 3px;
        font-size: 2.5rem;
        margin-bottom: 0 !important;
      }

      .main-area {
        min-height: calc(100vh - var(--header-height));
        padding: 1rem 0 2rem 0;
        box-sizing: border-box;
      }

      .columns.is-variable {
        gap: 1.5rem;
        margin: 0;
      }

      .canvas-box {
        padding: 0;
        background: #000000;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 8px 32px rgba(155, 127, 185, 0.2);
        border: 2px solid var(--accent-purple);
      }

      #glcanvas {
        width: 100%;
        aspect-ratio: 1 / 1;
        background: #000000;
        display: block;
      }

      .panel-box {
        padding: 1rem;
        margin-bottom: 1rem;
        background: var(--card-bg);
        border-radius: 10px;
        border: 1px solid rgba(155, 127, 185, 0.2);
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
      }

      .panel-box:hover {
        border-color: var(--accent-purple);
        box-shadow: 0 6px 24px rgba(155, 127, 185, 0.3);
        transform: translateY(-2px);
      }

      .panel-box .subtitle {
        margin-bottom: 0.75rem;
        font-size: 1rem;
        font-weight: 600;
        color: var(--accent-purple);
        font-family: 'Orbitron', sans-serif;
        letter-spacing: 1px;
        text-transform: uppercase;
      }

      .panel-box .field {
        margin-bottom: 0.5rem;
      }

      .panel-box .label {
        font-size: 0.85rem;
        margin-bottom: 0.5rem;
        color: #495057;
        font-weight: 600;
      }

      .slider-output {
        min-width: 2.5rem;
        text-align: right;
        margin-left: 0.75rem;
        font-size: 0.9rem;
        font-weight: 600;
        color: var(--accent-purple);
      }

      .button.is-primary {
        background: var(--accent-purple);
        border: none;
        color: white;
        font-weight: 600;
        font-family: 'Rajdhani', sans-serif;
        letter-spacing: 1px;
        text-transform: uppercase;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(155, 127, 185, 0.3);
      }

      .button.is-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 25px rgba(155, 127, 185, 0.5);
        background: #8a6ca8;
      }

      .input[type="file"] {
        background-color: var(--card-bg);
        border: 2px solid rgba(155, 127, 185, 0.3);
        border-radius: 8px;
        color: var(--text-light);
        padding: 0.75rem;
        transition: all 0.3s ease;
      }

      .input[type="file"]:hover {
        border-color: var(--accent-purple);
      }

      .input[type="file"]::file-selector-button {
        background: var(--accent-purple);
        border: none;
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 6px;
        cursor: pointer;
        font-weight: 600;
        margin-right: 1rem;
        vertical-align: middle;
        line-height: 1.2;
      }

      input[type="range"] {
        -webkit-appearance: none;
        appearance: none;
        background: transparent;
        cursor: pointer;
        width: 100%;
      }

      input[type="range"]::-webkit-slider-track {
        background: var(--accent-purple);
        height: 6px;
        border-radius: 3px;
      }

      input[type="range"]::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        margin-top: -6px;
        background: #8a6ca8;
        height: 18px;
        width: 18px;
        border-radius: 50%;
        border: 3px solid var(--primary-dark);
        box-shadow: 0 0 10px rgba(155, 127, 185, 0.6);
      }

      input[type="range"]::-moz-range-track {
        background: var(--accent-purple);
        height: 6px;
        border-radius: 3px;
      }

      input[type="range"]::-moz-range-thumb {
        background: #8a6ca8;
        height: 18px;
        width: 18px;
        border-radius: 50%;
        border: 3px solid var(--primary-dark);
        box-shadow: 0 0 10px rgba(155, 127, 185, 0.6);
      }

      #status {
        color: #6c757d;
        font-style: italic;
      }

      .camera-container {
        background: #ffffff;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 8px 32px rgba(155, 127, 185, 0.2);
        border: 2px solid var(--accent-purple);
      }

      .columns.is-mobile .column {
        padding: 0.25rem;
      }
    </style>
  </head>

  <body>
    <!-- header -->
    <div class="header-section">
      <div class="container">
        <h1 class="title">Dummy Mirroring w/ Rays & Shaders</h1>
      </div>
    </div>

    <div class="container">
      <!-- status message -->
      <section class="section">
        <p id="status" class="has-text-grey"></p>
      </section>

      <div class="main-area">
        <div class="container">
          <div class="columns is-variable">
            <!-- Left Column: 3D Canvas -->
            <div class="column is-6">
              <div class="box canvas-box">
                <canvas id="glcanvas"></canvas>
              </div>
            </div>

            <!-- Right Column: Camera Feed with Pose Detection -->
            <div class="column is-6">
              <!-- Scene File Selection -->
              <div class="panel-box" style="padding: 0.6rem; margin-bottom: 0.6rem;">
                <h2 class="subtitle is-5" style="font-size: 0.85rem; margin-bottom: 0.4rem;">Scene File</h2>
                <div class="field">
                  <label class="label" style="font-size: 0.75rem; margin-bottom: 0.3rem;">Choose a Scene file:</label>
                  <div class="control" style="display: flex; justify-content: center;">
                    <input id="xmlInput" class="input" type="file" accept=".xml" style="padding: 0.5rem; font-size: 0.85rem; max-width: 100%;" />
                  </div>
                </div>
              </div>

              <!-- Max Depth Slider -->
              <div class="panel-box" style="padding: 0.6rem; margin-bottom: 0.6rem;">
                <h2 class="subtitle is-5" style="font-size: 0.85rem; margin-bottom: 0.4rem;">Max Depth</h2>
                <div class="field">
                  <div class="control is-flex is-align-items-center">
                    <input
                      id="maxDepth"
                      class="slider is-fullwidth"
                      type="range"
                      min="1"
                      max="5"
                      value="2"
                    />
                    <output id="maxDepthVal" class="slider-output">2</output>
                  </div>
                </div>
              </div>

              <div class="panel-box">
                <h2 class="subtitle is-5">Pose Detection</h2>
                <div class="field">
                  <button
                    id="webcamButton"
                    class="button is-primary is-fullwidth"
                  >
                    Enable Webcam
                  </button>
                </div>
                <div style="display: flex; justify-content: center; margin-top: 1rem;">
                  <div class="camera-container" style="position: relative; display: inline-block; width: auto;">
                    <video id="webcam" style="display: block; max-width: 100%;" autoplay playsinline></video>
                    <canvas class="output_canvas" id="output_canvas" width="640" height="480" style="position: absolute; left: 0px; top: 0px; max-width: 100%;"></canvas>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- glMatrix -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gl-matrix/2.8.1/gl-matrix-min.js"></script>

    <!-- a4 driver -->
    <script>
      var renderer = null;
    </script>
    <script type="module" src="main.js"></script>
  </body>
</html>
